<!-- Curved Falling Lines (converge center, top→bottom, +2 side lines, +30% curve, focus point = bottom-70) -->
<!doctype html><html lang="vi"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Curved Falling Lines</title>
<style>
  html,body{height:100%;margin:0;background:#0E1011;overflow:hidden}
  svg{position:fixed;inset:0;width:100%;height:100%;display:block}
  .track{fill:none;stroke:rgba(255,255,255,.08);stroke-width:1}
  .runner{fill:none;stroke:var(--color);stroke-width:1;stroke-linecap:round;
    animation:fall var(--dur) linear infinite;animation-delay:var(--delay);
    animation-timing-function:cubic-bezier(.4,.26,0,.97)}
  @keyframes fall{from{stroke-dashoffset:var(--start)}to{stroke-dashoffset:var(--end)}}
  @media (prefers-reduced-motion:reduce){.runner{animation:none}}
</style>
</head><body>
<svg id="stage" preserveAspectRatio="none"></svg>
<script>
/* ===== params giữ nguyên tinh thần bản trước ===== */
const PALETTE = ["#FFC413","#00A652","#FFBCFC","#4A4A48","#00A652","#C4C8FF"];
const LINE_COUNT = 14;          // 12 + 2 line ở 2 bên
const MIN_DELAY = 0, MAX_DELAY = 3.5;
const SPEED_S = 7;              // tốc độ rơi
const MIN_LEN = 50, MAX_LEN = 150; // chiều dài vệt
const CURVE_BOOST = 1.3;        // +30% độ uốn
const FOCUS_OFFSET = 70;        // điểm chụm cách mép dưới 70px

const svg = document.getElementById('stage');
const pick = a => a[(Math.random()*a.length)|0];
const rand = (a,b) => a + Math.random()*(b-a);

/* đường cong chụm vào tâm đáy (cách đáy 70px), tăng độ uốn 30% */
function makeCurvedPathD(x0, w, h){
  const cx = w*0.5, cy = h - FOCUS_OFFSET;     // điểm hội tụ
  const tCloser = 0.8 + 0.2*(CURVE_BOOST-1);   // kéo gần tâm hơn
  const c1y = h * (0.35 * (2 - CURVE_BOOST));  // cong sớm hơn
  const c2x = x0 + (cx - x0) * tCloser;
  const c2y = h * (0.78 - 0.15*(CURVE_BOOST-1));
  return `M ${x0},0 C ${x0},${c1y} ${c2x},${c2y} ${cx},${cy}`;
}

function build(){
  svg.innerHTML = '';
  const w = svg.clientWidth, h = svg.clientHeight;
  svg.setAttribute('viewBox', `0 0 ${w} ${h}`);

  // tạo vị trí X: thêm 2 line sát 2 bên (inset nhẹ), phần còn lại chia đều
  const inset = Math.min(60, w*0.06);
  const xs = [0, inset];
  const mid = LINE_COUNT - 4; // còn lại ở giữa
  for (let i=1;i<=mid;i++) xs.push((i/(mid+1))*w);
  xs.push(w-inset, w);

  xs.forEach(x=>{
    const d = makeCurvedPathD(x, w, h);

    // track mờ
    const track = document.createElementNS('http://www.w3.org/2000/svg','path');
    track.setAttribute('class','track'); track.setAttribute('d', d); svg.appendChild(track);

    // runner màu (chạy LIỀN MẠCH từ trên xuống)
    const r = document.createElementNS('http://www.w3.org/2000/svg','path');
    r.setAttribute('class','runner'); r.setAttribute('d', d); svg.appendChild(r);

    const pathLen = r.getTotalLength();
    const segLen  = Math.round(rand(MIN_LEN, MAX_LEN));   // 50–150px
    r.style.strokeDasharray = `${segLen} ${pathLen}`;
    // 👉 luôn đi từ TRÊN xuống: bắt đầu -seg (ngoài khung trên) → kết thúc pathLen+seg (qua khỏi đáy)
    r.style.setProperty('--start', `-${segLen}px`);
    r.style.setProperty('--end',   `${pathLen + segLen}px`);
    r.style.setProperty('--dur',   `${SPEED_S}s`);
    r.style.setProperty('--delay', `${rand(MIN_DELAY, MAX_DELAY).toFixed(2)}s`); // lệch pha ban đầu
    r.style.setProperty('--color', pick(PALETTE));
  });
}

build();
addEventListener('resize', build, {passive:true});
</script>
</body></html>
